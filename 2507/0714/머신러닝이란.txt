
머신러닝이란 => 기계학습
분류 또는 회귀
분류는 데이터가 반드시 범주형이어야 한다.
타이타닉에서 생존자 분류하기
어린아이와 여자들, 1등선실.
생존예측, 살았느냐 죽었느냐 0.5만큼 죽어있다.
암환자예측
종류예측 - 카테고리

회귀는 연속적 값들, 키나 부동산 가격, 대기중 이산화탄소 양 예측, 방사능량 예측
자동차연비 => 보통의 경우는 회귀. 
수치만 갖고는 알기 어려울 경우 강제로 구간을 나눈다.
등급화를 해서 그떄는 분류문제로 바뀐다.
회귀는 실수값으로 말해야 하고, 분류는 확률로 결과를 말해야 한다.

회귀의 첫 번째 모델은 선형회귀모델,
분류의 첫번째 모델은 로지스틱회귀이다.
y = ax +b	# 문제를 최소화한다.
x = [1, 2, 1.6, 2.6, 3, 2, 5, 7]		# 독립변수
y = [2, 4, 6, 4.4, 7.8, 2.1, 6.5, 9]	# 종속변수
	x에 의해 영향을 받는 변수라는 의미이다.
	원칙적으로 y는 하나이고 x는 여러 개일 수도 있다.
	수많은 독립변수가 있고 그 중에서 누가 중요한지 모르기 때문에
	x마다 별도의 기울기(계수)가 필요하다.

a하고 b가 뭔지 모른다.
a하고 b의 후보집합을 처음엔 랜덤하게 만든다.
y = ax + b 	(a, b 집합에 대해서)
최소제곱법 - 오차의 제곱의 합이 최소가 되게하는 a와 b를 찾아나가기
a와 b를 추정한다. 추세선.
y와 x간의 산포도를 그린 다음에 그 산포도를 예측할 수 있는 추세선을 그린다.
결과값이 실수가 나온다.

로지스틱회귀분석은 선형회귀모델을 이용해서 분류를 하는데 예측해보면 값이 실수가 나온다.
이 값을 확률로 바꿀 마법의 함수 - 시그모이드 함수 결과를 0~1 사이에 머무르게 한다.
결과를 확률로 맞춘다.

휴리스틱분석: 어림짐작으로 경험칙으로 분석을 해나간다.
그래서 안 맞으면 처음부터 다시 한다.
1. 데이터 수집, 어떤 특성이 결과에 영향을 미칠지 아무도 모른다. 그러니까 아무거나 수집해본다.
결측치 - 어떤 특성이 NaN값이 절반이 넘음, 완전히 특성 제거를 할지 아니면 대체값으로 대체를 할지.
대체값이 평균을 할지 중간값(회귀)으로 할지 아니면 최빈수(분류)를 할지 특성의 성격에 따라 각기 다른 대응
이상치 제거 - 지나치게 이상한 값들. IQR을 많이 사용한다.
중복치 제거 - 데이터 수집단계에서 잘못된 수집
특성의 타입이 문자열이거나 또는 숫자라도 범주형타입일 경우 카테고리타입 지정을 해야 한다.
라벨인코딩(범주의 범위가 작을 때), 원핫인코딩(범주의 범위가 클 때) 작업 등을 진행해서 데이터가 연산이 가능하게 만들어줘야 한다.

2. 모델을 결정해서 학습을 한다.
학습을 했어 결과 나왔는데 이 모델이 실제 데이터를 맞출지를 어떻게 확신하지?
적어도 훈련셋과 테스트셋으로 나누자.
훈련셋을 기반으로 학습을 하고 그 다음에 테스트셋을 가지고 테스트를 해보자.
평가라는 걸 해보자. 평가 방법도 모델에 score 함수로 해봤는데 이걸 원래는 정밀하게 평가하는 함수가 따로 있다.
회귀와 분류에 따라서 평가 방법이 다르다. (오늘 배움)

목표: 일반화(특정 데이터셋에 맞춰지는 것이 아니라 새로운 데이터셋에도 적용이 되어야 한다.)
과소적합 - 학습이 덜된 상태, 훈련셋도 예측률이 낮고 테스트셋도 낮다.
그치만 원래 데이터셋이 너무 작아서 그 작은 예측률이 과대적합일 수도 있다.
과대적합 - 지나치게 학습이 많이 된 상태. 훈련셋 예측률과 테스트셋 
예측률이 차이가 많이 나는 경우를 과대적합이라 한다.

1) 데이터셋이 많아야 한다.
청주에서 양동이 물 들이붓는 소리가 나는데, 6시간동안 폭우
청주 관측이래 최대의 비였음. 이 데이터가 지금같으면 예측 데이터로 들어감.

2) 특성이 너무 많아도 과대적합이 된다.
특성이 많아지면 모델 내부가 너무 복잡해져서 과대적합이 일어난다.
그래서 중요특성만 추출(의사결정트리) 등을 통해서 특성을 제거시킨다거나 PCA(주요성분분석) 등을 통해 특성들을 조작(복잡한 과정)해서 새로운 특성을 만들어 낸다.
기타 알고리즘이 아주 많음 - 특성공학

3) 알고리즘들에 있는 하이퍼파라미터를 조절하여 적절한 값을 찾아내야 한다.
(그리드서치-(옵투나)나 파이프라인 등을 활용)
서포트벡터머신, 랜덤포레스트(앙상블), 그라디언트부스팅(xgboost)...

4) 스케일링 - 단위 맞춰주기, 서포트벡터머신하고 딥러닝에 유용하다.

검증하기 kfold


